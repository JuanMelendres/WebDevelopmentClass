<html>
  <head>
    <meta charset="utf-8">
    <title>Vue Semestre i</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
   
    <style>

      #form > input {
        display: flex;
        margin-bottom: 10px;
        width: 100%;
        padding: 12px 20px;
        margin: 8px 0;
        box-sizing: border-box;
      }

      .button {
        padding: 15px 32px;
        text-align: center;
        display: inline-block;
        font-size: large;
      }

      #add {
        background-color: #27cc2c; /* Green */
        border-radius: 1rem;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: large;
      }

    </style>

  </head>
  	<body>
        <div id="lugardetrabajo">
          <h1>Actividad 1</h1>
          {{ nombre }}

          <div class="ui form">
            <div class="field">
              <br>
              <label>User Input</label>
              <input type="text" v-model="libros[0].autor">
              <br>
            </div>
          </div>
          <br>
          <button class="ui button" v-on:click="metodo">
            Otro libro
          </button>
          <br>

          <ul v-for="(book, i) in ordenarLibros">
            <li v-if="book.oferta" style="font-size: large; color: brown;">
              {{ book.autor }} - {{ book.titulo }} - disponibles {{ book.cantidad }} - {{ book.descuento }} %
              <button v-on:click="deleteBook(i)">Eliminar</button>
              <button v-on:click="edit(i)">Editar</button>
            </li>
            <li v-else>
              {{ book.autor }} - {{ book.titulo }} - disponibles {{ book.cantidad }} - No hay oferta :(
              <button v-on:click="deleteBook(i)">Eliminar</button>
              <button v-on:click="edit(i)">Editar</button>
            </li>
          </ul>

          <div v-if="show">
            <h1>Actividad 3</h1>
            <div id='form'>
              <input type="text" id="nameField" v-model="editFields.author" placeholder="nombre">
              <input type="text" id="titleField" v-model="editFields.title" placeholder="Título">
              <div id="offer">
                <label for="oferta">Tiene oferta</label>
                <input type="checkbox" value="true" v-model="editFields.oferta">
              </div>
              <input v-if="editFields.oferta" type="number" id="descuentoField" v-model="editFields.descuento" placeholder="Descuento">
              <input type="number" id="cantidadField" v-model="editFields.cantidad" placeholder="Cantidad">
              <button id="add" v-on:click="updateBook">Editar</button>
            </div>
          </div>

          <div>
            <h1>Actividad 2</h1>
            <div id='form'>
              <input type="text" id="nameField" v-model="inputFields.author" placeholder="nombre">
              <input type="text" id="titleField" v-model="inputFields.title" placeholder="Título">
              <div id="offer">
                <label for="oferta">Tiene oferta</label>
                <input type="checkbox" value="true" v-model="inputFields.oferta">
              </div>
              <input v-if="inputFields.oferta" type="number" id="descuentoField" v-model="inputFields.descuento" placeholder="Descuento">
              <input type="number" id="cantidadField" v-model="inputFields.cantidad" placeholder="Cantidad">
              <button id="add" v-on:click="addBook">Agregar nuevo</button>
            </div>
          </div>
          <br>
        </div>

        <div id="espacio">
           espacio
        </div>
        


		  <script type="text/javascript">
          //Una instancia de Vue que manejará esa área del documento #lugardetrabajo
          c = new Vue({
            el: "#lugardetrabajo",
            data :{
              ifActive: true,
              nombre: "La elegante vagancia",
              libros:[
                {
                  autor: "Ray Bradbury",
                  titulo: "Fahrenheit 451",
                  oferta: true,
                  cantidad: 24,
                  descuento: 50,
                },
                {
                  autor:"Clarke",
                  titulo:"la infancia",
                  oferta: false,
                  cantidad: 12,
                  descuento: null,
                },
                {
                  autor:"Arthur P.",
                  titulo:"El fin",
                  oferta: true,
                  cantidad: 40,
                  descuento: 30,
                },
                {
                  autor:"C. Clarke",
                  titulo:"El fin de la vida",
                  oferta: false,
                  cantidad: 5,
                  descuento: null,
                }
              ],
              inputFields: {
                author: "",
                title: "",
                oferta: false,
                cantidad: null,
                descuento: null
              },
              editFields: {
                author: "",
                title: "",
                oferta: false,
                cantidad: null,
                descuento: null
              },
              show:Boolean = false,
              currentIndex: Number = 0,
            },
            methods: {
              metodo: function() {
                console.log("click");
              },
              addBook: function() {
                if (this.inputFields.author == "" ||
                    this.inputFields.title == "" || 
                    this.inputFields.cantidad == null) {
                  alert("Debes de completar los inputs");
                } else {
                  this.libros.push({
                    autor: this.inputFields.author,
                    titulo: this.inputFields.title,
                    oferta: this.inputFields.oferta,
                    cantidad: this.inputFields.cantidad,
                    descuento: this.inputFields.descuento,
                  });
                    this.inputFields.author = "";
                    this.inputFields.title = ""; 
                    this.inputFields.oferta = false;
                    this.inputFields.cantidad = null;
                    this.inputFields.descuento = false;
                }
              },
              deleteBook: function(index) {
                this.libros.splice(index, 1);
              },
              edit: function(index) {
                this.show = true;
                this.currentIndex = index
              },
              updateBook: function() {
                aux = this.libros[this.currentIndex];

                aux.autor = this.editFields.author,
                aux.titulo = this.editFields.title,
                aux.oferta = this.editFields.oferta,
                aux.cantidad = this.editFields.cantidad,
                aux.descuento = this.editFields.descuento
              }
            },
            computed: {
              ordenarLibros: function(){
                console.log("computed");
                return _.orderBy(this.libros, ['autor'])
              }
            }
          });

		  </script>
	</body>
</html>